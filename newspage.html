<!DOCTYPE html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
	<title>明築建設官網-最新消息</title>
	<meta name="author" content="" />
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<meta name="Resource-type" content="" />
	<!-- <link rel="icon" href="img/logo.ico"> -->
	<!-- <meta property="og:image" content="../img/index/1200x628.jpg"> -->

	<!-- css -->
	<link rel="stylesheet" type="text/css" href="css/reset.css" />
	<link rel="stylesheet" type="text/css" href="css/slick.css" />
	<link rel="stylesheet" type="text/css" href="css/slick-theme.css" />
	<link rel="stylesheet" type="text/css" href="css/animate.css" />
	<link rel="stylesheet" type="text/css" href="css/index.css" />
	<link rel="stylesheet" type="text/css" href="css/news.css" />
	<link rel="stylesheet" type="text/css" href="css/popup_photo.css" />
	<!-- js -->
	<script src="js/jquery-3.6.0.min.js"></script>
	<script src="js/slick.js"></script>
	<script src="js/wow.min.js"></script>
</head>

<body>
	<header id="header"></header>

	<section>
		<div class="theme">
			<div class="theme_news">
                <div class="theme_news_page">
                    <div class="theme_news_page_slider">
                        <div class="theme_news_page_item">
                            <div class="theme_news_page_topic">
                                <div class="theme_news_page_topic_date wow fadeInRight" data-wow-duration="1s" data-wow-delay="0.5s">
                                    <span>2023</span>06.01
                                </div>
                                <div class="theme_news_page_topic_title wow fadeInRight" data-wow-duration="1s" data-wow-delay="1s">
                                    <h3>主題</h3>
                                    <h4>
                                        <span>標籤 ｜</span>
                                        副標寫在這
                                    </h4>
                                </div>
                            </div>
                            <div class="theme_news_page_content wow fadeInRight" data-wow-duration="1s" data-wow-delay="1.5s">
                                    內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案。
                            </div>
                            <div class="theme_news_page_photo">
                                <div class="theme_news_page_photo_item wow fadeInRight" data-wow-duration="1s" data-wow-delay="0.2s">
                                    <img class="active_popup" src="img/news_page_photo1.jpg" alt="">
                                </div>
                                <div class="theme_news_page_photo_item wow fadeInRight" data-wow-duration="1s" data-wow-delay="0.4s">
                                    <img class="active_popup" src="img/news_page_photo1.jpg" alt="">
                                </div>
                                <div class="theme_news_page_photo_item wow fadeInRight" data-wow-duration="1s" data-wow-delay="0.6s">
                                    <img class="active_popup" src="img/news_page_photo1.jpg" alt="">
                                </div>
                                <div class="theme_news_page_photo_item wow fadeInRight" data-wow-duration="1s" data-wow-delay="0.8s">
                                    <img class="active_popup" src="img/news_page_photo1.jpg" alt="">
                                </div>
                                <div class="theme_news_page_photo_item wow fadeInRight" data-wow-duration="1s" data-wow-delay="1s">
                                    <img class="active_popup" src="img/news_page_photo1.jpg" alt="">
                                </div>
                                <div class="theme_news_page_photo_item wow fadeInRight" data-wow-duration="1s" data-wow-delay="1.2s">
                                    <img class="active_popup" src="img/news_page_photo1.jpg" alt="">
                                </div>
                                <div class="theme_news_page_photo_item wow fadeInRight" data-wow-duration="1s" data-wow-delay="1.4s">
                                    <img class="active_popup" src="img/news_page_photo1.jpg" alt="">
                                </div>
                                <div class="theme_news_page_photo_item wow fadeInRight" data-wow-duration="1s" data-wow-delay="1.6s">
                                    <img class="active_popup" src="img/news_page_photo1.jpg" alt="">
                                </div>
                            </div>
                        </div>
                        <div class="theme_news_page_item">
                            <div class="theme_news_page_topic">
                                <div class="theme_news_page_topic_date">
                                    <span>2023</span>06.01
                                </div>
                                <div class="theme_news_page_topic_title">
                                    <h3>主題</h3>
                                    <h4>
                                        <span>標籤 ｜</span>
                                        副標寫在這
                                    </h4>
                                </div>
                            </div>
                            <div class="theme_news_page_content">
                                    內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案內容文案。
                            </div>
                            <div class="theme_news_page_photo">
                                <div class="theme_news_page_photo_item">
                                    <img class="active_popup" src="img/news_page_photo2.jpg" alt="">
                                </div>
                                <div class="theme_news_page_photo_item">
                                    <img class="active_popup" src="img/news_page_photo2.jpg" alt="">
                                </div>
                                <div class="theme_news_page_photo_item">
                                    <img class="active_popup" src="img/news_page_photo2.jpg" alt="">
                                </div>
                                <div class="theme_news_page_photo_item">
                                    <img class="active_popup" src="img/news_page_photo2.jpg" alt="">
                                </div>
                                <div class="theme_news_page_photo_item">
                                    <img class="active_popup" src="img/news_page_photo2.jpg" alt="">
                                </div>
                                <div class="theme_news_page_photo_item">
                                    <img class="active_popup" src="img/news_page_photo2.jpg" alt="">
                                </div>
                                <div class="theme_news_page_photo_item">
                                    <img class="active_popup" src="img/news_page_photo2.jpg" alt="">
                                </div>
                                <div class="theme_news_page_photo_item">
                                    <img class="active_popup" src="img/news_page_photo2.jpg" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="btn_back" id="btn_back">
                    <a href="news.html">
                        <img src="img/icon_back.svg" alt="">
                        BACK<br>回列表頁
                    </a>
                </div>
			</div>
		</div>
	</section>

	<div class="popup popup_photo">
		<div class="popup_content popup_img">
            <div class="photo">
                <img src="img/news_page_photo1.jpg" alt="">
                <span>照片描述111</span>
            </div>
        </div>
        <div class="icon close">
            <span class="material-icons">
                close
            </span>
        </div>
        <div class="icon allphoto">
            <span class="material-icons">
                apps
            </span>
        </div>
        <div class="icon play">
            <span class="material-icons">
                play_arrow
            </span>
        </div>
        <div class="arrow">
            <button class="prev">
                <a href="#0">
                    <span class="line"></span>
                    <span class="line"></span>
                    <div class="arrow"></div>
                </a>
            </button>
            <button class="next">
                <a href="#0">
                    <span class="line"></span>
                    <span class="line"></span>
                    <div class="arrow"></div>
                </a>
            </button>
        </div>
	</div>
	
	<footer id="footer"></footer>

</body>
<script>
    // 目前顯示的照片索引
    let currentPhotoIndex = 0;
    let $photoItems ;
	$(document).ready(function () {
		new WOW().init();

		$('#header').load('page/header.html');
		$('#footer').load('page/footer.html');

		$('.theme_news_page_slider').slick({
			dots: false,
			arrows: true,
			infinite: false,
			slidesToShow: 1,
			slidesToScroll: 1,
            lazyLoad: 'ondemand',
            draggable: false,
			prevArrow: '<button class="prev-news"><a href="#0"><span class="material-icons">arrow_left</span>PREV</a></button><button class="prev-news"><a href="#0"><span class="material-icons">arrow_left</span>PREV<br>上一則</a></button>',
			nextArrow: '<button class="next-news"><a href="#0"><span class="material-icons">arrow_right</span>NEXT</a></button><button class="next-news"><a href="#0"><span class="material-icons">arrow_right</span>NEXT<br>下一則</a></button>',
		});

		$('.theme_news_page_slider').append($('#btn_back'));

        // 監聽輪播切換事件
        $('.theme_news_page_slider').on('afterChange', function(event, slick, currentSlide) {
            // 在這裡根據切換到的頁面（currentSlide）執行相應的動作
            InitClickPopupImg();
        });

        InitClickPopupImg();

        // // 獲取 prev 和 next 按鈕
        const prevButton = $('.popup_photo .prev');
        const nextButton = $('.popup_photo .next');
        // 點擊 "prev" 按鈕時切換到前一張相片
        prevButton.on('click', function() {
            currentPhotoIndex = (currentPhotoIndex - 1 + $photoItems.toArray().length) % $photoItems.toArray().length;
            updatePopupImage(currentPhotoIndex);
        });

        // 點擊 "next" 按鈕時切換到後一張相片
        nextButton.on('click', function() {
            currentPhotoIndex = (currentPhotoIndex + 1) % $photoItems.toArray().length;
            updatePopupImage(currentPhotoIndex);
        });

        $(".popup_photo .close").click(function() {
            $(".popup_photo").removeClass("is_acted");
        });
            
	})

    function InitClickPopupImg() {
        if($photoItems){
            $photoItems.off('click');
        }
        const $currentSlide = $('.slick-slide.slick-current.slick-active .theme_news_page_photo');
        $photoItems = $currentSlide.find('.theme_news_page_photo_item');
        //console.log($photoItems);
        // 點擊照片預覽項目時顯示對應的照片及描述
        $photoItems.toArray().forEach(function(item, index) {
            item.addEventListener('click', function() {
                updatePopupImage(index);
            });
        });
    }

    function updatePopupImage(index) {
        console.log("updatePopupImage");
        const $imgSrc = $photoItems.eq(index).find('img').attr('src');
        const $imgDescription = $photoItems.eq(index).find('img').attr('alt');
        const $popupImg = $('.popup_content.popup_img');
        $popupImg.find('img').attr('src', $imgSrc);
        $popupImg.find('span').text($imgDescription);
        currentPhotoIndex = index;
        $(".popup_photo").addClass("is_acted");
    }

</script>
</html>